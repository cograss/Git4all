' Gambas class file

Public Sub Form_Open()

  '''''''''' load contents to cmbProfile ComboBox
  If Not Exist(main.glbProfilesFile) Then 'if Profiles file dont exist.
    myFunctions.comboLoader(cmbProfile, "init/gitProfile") 'add content from /init file.
  Else
    myFunctions.comboLoader(cmbProfile, main.glbProfilesFile) 'add content from Profiles file.
  Endif
  '''''''''' end of loading contents
  Wait
  Me.Center
  loadUserData() 'calls loadUsedData function
End


Public Sub btnNew_Click() 'click the New Account button.
  Dim myProfile As String
  
  myProfile = InputBox(("Profile Name"), ("Enter new profile name")) 'gets profile name from user
  If Trim(myProfile) = main.glbProfile Or Trim(myProfile) = "" Then Return 'exits the function
  cmbProfile.Add(myProfile, cmbProfile.Index + 1) 'adds profilename to ComboBox

End

Public Sub loadUserData() 'get data from lines 1-3 in file and
Dim strFile As String

strFile = main.glbAppDir & cmbProfile.Text 'the data file now is .git4all/Profilename

If Not Exist(strFile) Then strFile = "init/gitAccount" 'get data from provided init/ folder
myFunctions.textBoxLoader(txtBoxUser, strFile, 1)
myFunctions.textBoxLoader(txtBoxPwd, strFile, 2)
myFunctions.textBoxLoader(txtBoxEmail, strFile, 3)

End


Public Sub btnCancel_Click()

  Me.Close

End

Public Sub textBoxSaver(TextBoxName As TextBox, filepath As String)

Dim hFile As Stream
Dim sLine As String
sLine = TextBoxName.Text

    If sLine Not Null Then 
      hFile = Open filepath For Output 'opens file   
      Print #hFile, sLine & Chr(13) 
      Close #hFile
    Endif
End
