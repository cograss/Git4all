' Gambas class file

Public Sub Form_Open()

  '''''''''' load contents to cmbProfile ComboBox
  If Not Exist(main.glbProfilesFile) Then 'if Profiles file dont exist.
    myFunctions.comboLoader(cmbProfile, "init/gitProfile") 'add content from /init file.
  Else
    myFunctions.comboLoader(cmbProfile, main.glbProfilesFile) 'add content from Profiles file.
  Endif
  '''''''''' end of loading contents
  Wait
  Me.Center
  loadUserData() 'calls loadUsedData function
End


Public Sub btnNew_Click() 'click the New Account button.
Dim myProfile As String

myProfile = InputBox(("Profile Name"), ("Enter new profile name")) 'gets profile name from user
  If Trim(myProfile) = main.glbProfile Or Trim(myProfile) = "" Then Return 'exits the function.

  ''
  ''   TODO: make a search function to prevent double entries in ProfilesFile.
  ''
  cmbProfile.Add(myProfile, cmbProfile.Index + 1) 'adds profilename to ComboBox.
  cmbProfile.Index += 1 'changes to new added item.

End

Public Sub loadUserData() 'get data from lines 1-3 in file and load to textboxes.
Dim strFile As String

  strFile = main.glbAppDir &/ cmbProfile.Text 'the data file now is .git4all/Profilename

  If Not Exist(strFile) Then strFile = "init/gitAccount" 
  myFunctions.textBoxLoader(txtBoxUser, strFile, 1) 'call txtBoxLoader() to add content to txtBoxUser.Text
  myFunctions.textBoxLoader(txtBoxPwd, strFile, 2)
  myFunctions.textBoxLoader(txtBoxEmail, strFile, 3)
End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub btnSave_Click() ' activated when Save button is pressed
Dim myText, myPath As String
Dim myTextBox As New TextBox(Me) 'used to get text from other controls.

myText = cmbProfile.Current.Text ' a trick to use ComboBox.Text, 
myTextBox.Text = myText          ' as TextBox.Text (copy contents to a virtual TextBox).

'''''''' Save profile name from Combobox.Text to profiles file.
mypath = main.glbProfilesFile
myFunctions.textBoxSaver(myTextBox, mypath) 'call TextBoxSaver() to save ProfileName from cmbProfile to ProfilesFile.
''''''' Save data to new profile
''
''  TODO: Save profile data To main.glbAppDir/main.glbProfile File.
''
''
Message.Info(("Profile saved."))
Me.Close
End
